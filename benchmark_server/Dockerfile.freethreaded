ARG PYTHON_IMAGE=ghcr.io/abebus/free-threaded-python-docker-image:main

FROM $PYTHON_IMAGE

# This means 'do not warn about it' :)
ENV PIP_ROOT_USER_ACTION=ignore

ENV PIP_NO_CACHE_DIR=true
ENV PIP_DISABLE_PIP_VERSION_CHECK=true

# Can be used only on free-threaded builds.
ENV PYTHON_GIL=0

RUN pip install -U pip

COPY servers /usr/src/servers

ARG EASYNETWORK_SDIST

COPY $EASYNETWORK_SDIST /easynetwork.tar.gz
RUN pip install "/easynetwork.tar.gz"
